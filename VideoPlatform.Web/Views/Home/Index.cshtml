@model VideoPlatform.Domain.DTOs.PublishedVideoListingDTO
@{
    ViewData["Title"] = "Index";
}

<h2>Published Video Library</h2>

<div class="row">
    @if (Model.Seasons != null)
    {
        @foreach (var season in Model.Seasons)
        {
            <div class="p-2 border border-1 w-100">
                <h3>Season @season.Title</h3>
                <p>@season.Description</p>

                @if (season.Episodes != null && season.Episodes.Any())
                {
                    <div class="row">
                        @foreach (var episode in season.Episodes)
                        {
                            <div class="col-12 col-md-4 mb-4">
                                <div class="card d-flex flex-column h-100 rounded-0 rounded-bottom">
                                    <div class="card-body d-flex flex-column p-0">
                                        <video class="w-100 p-0 m-0" controls>
                                            <source src="@episode.FilePath" type="video/mp4">
                                        </video>
                                        <div class="p-2 flex-grow-1">
                                            <h5 class="card-title mt-2 mb-0">@episode.Title</h5>
                                            <p class="card-text mt-1 mb-3">
                                                <small class="text-muted">@episode.PublishDate.ToString("MMMM dd, yyyy")</small>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted">No episodes available.</p>
                }
            </div>
        }
    }

    <div class="p-2 border border-1 w-100 mt-3">
        <h3>Standalone Episodes</h3>
        <p>Episodes that are not in a season</p>

        @if (Model.StandaloneEpisodes != null && Model.StandaloneEpisodes.Any())
        {
            <div class="row">
                @foreach (var episode in Model.StandaloneEpisodes)
                {
                    <div class="col-12 col-md-4 mb-4">
                        <div class="card d-flex flex-column h-100 rounded-0 rounded-bottom">
                            <div class="card-body d-flex flex-column p-0">
                                <video class="w-100 p-0 m-0" controls>
                                    <source src="@episode.FilePath" type="video/mp4">
                                </video>
                                <div class="p-2 flex-grow-1">
                                    <h5 class="card-title mt-2 mb-0">@episode.Title</h5>
                                    <p class="card-text mt-1 mb-3">
                                        <small class="text-muted">@episode.PublishDate.ToString("MMMM dd, yyyy")</small>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-muted">No standalone episodes available.</p>
        }
    </div>
</div>
